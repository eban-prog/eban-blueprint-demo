<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#003B73" />
<title>ÉBAN Blueprint — Ethical Social Tech Demo</title>
<style>
  :root{
    --blue:#003B73;
    --blue-2:#0B2A4A;
    --navy:#002B5A;
    --terra:#D9643A;
    --terra-100:#FFE7DC;
    --green:#0EAD69;
    --bg:#F5F8FC;
    --white:#FFFFFF;
    --muted:#4a5a6c;
    --text-dark:#1a3a5a;
    --radius:14px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--blue-2);
    font:15.5px/1.55 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    padding-bottom:80px;
  }

  /* Header */
  .eban-header{
    background:linear-gradient(180deg, var(--navy), #053566); 
    color:#fff; padding:18px 16px; text-align:center; 
    position:sticky; top:0; z-index:3; 
    box-shadow:0 6px 18px rgba(0,0,0,.08)
  }
  .header-logo{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
  }
  .header-logo img{
    height:32px;
    width:auto;
  }
  .header-logo div{
    text-align:left;
  }
  .eban-header h1{margin:0 0 4px; font-size:20px; letter-spacing:.3px}
  .eban-header p{margin:0; opacity:.9; font-weight:600; font-size:13.5px}

  main{padding:16px; max-width:980px; margin:0 auto}
  h2{margin:8px 0 14px; font-size:20px; letter-spacing:.2px; display:flex; align-items:center; gap:8px}

  /* Section Headers */
  .section-header{
    background:linear-gradient(135deg, rgba(0,59,115,0.08), rgba(0,59,115,0.04));
    border-left:4px solid var(--blue);
    padding:12px 16px;
    border-radius:10px;
    margin:16px 0 12px;
  }
  .section-header .title{
    font-weight:800; 
    color:var(--text-dark); 
    font-size:15px;
    letter-spacing:.3px;
    text-transform:uppercase;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .section-header .subtitle{
    font-size:13px;
    color:var(--muted);
    margin-top:4px;
  }

  .section-header.network{
    background:linear-gradient(135deg, rgba(14,173,105,0.08), rgba(14,173,105,0.04));
    border-left-color:var(--green);
  }

  /* Cards / KPIs */
  .kpi-grid{
    display:grid; 
    gap:14px; 
    grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
    animation:fadeInUp 0.5s ease;
  }
  
  @keyframes fadeInUp {
    from { opacity:0; transform:translateY(20px); }
    to { opacity:1; transform:translateY(0); }
  }

  .card{
    background:var(--white); 
    border:1px solid #E6ECF4; 
    border-radius:var(--radius);
    padding:16px 14px; 
    box-shadow:0 4px 12px rgba(0,0,0,.05);
    transition:transform 0.2s ease, box-shadow 0.2s ease;
  }
  
  .card:hover{
    box-shadow:0 6px 16px rgba(0,0,0,.08);
  }

  .kpi{
    display:flex; 
    flex-direction:column; 
    gap:8px; 
    min-height:118px; 
    position:relative;
  }
  
  .kpi .label{
    font-weight:800; 
    font-size:13px; 
    color:#2a4564; 
    text-transform:uppercase; 
    letter-spacing:.4px;
  }
  
  .kpi .value{
    font-size:32px; 
    font-weight:900; 
    color:var(--blue-2);
    font-variant-numeric:tabular-nums;
  }
  
  .kpi .sub{
    font-size:12.5px; 
    color:var(--muted);
    margin-top:auto;
  }
  
  .kpi.badge::before{
    content:attr(data-badge); 
    position:absolute; 
    top:10px; 
    right:10px;
    background:var(--terra-100); 
    color:#9a3d23; 
    border:1px solid #f1b39e;
    padding:3px 10px; 
    border-radius:999px; 
    font-weight:800; 
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.5px;
  }

  /* FAB */
  .fab{
    position:fixed; 
    right:20px; 
    bottom:90px;
    background:var(--terra); 
    color:#fff; 
    width:60px; 
    height:60px; 
    border-radius:50%;
    border:none; 
    box-shadow:0 8px 20px rgba(217,100,58,.3);
    font-size:28px; 
    cursor:pointer; 
    display:grid; 
    place-items:center;
    transition:all 0.3s ease;
    z-index:2;
  }
  
  .fab:hover{
    background:#c54f29;
    transform:scale(1.1);
    box-shadow:0 10px 24px rgba(217,100,58,.4);
  }
  
  .fab:active{
    transform:scale(0.95);
  }
  
  .fab:focus-visible{
    outline:3px solid #fff; 
    outline-offset:3px;
  }

  /* Form */
  .form .row{display:grid; gap:10px; margin-bottom:14px}
  .form label{font-weight:800; font-size:13.5px; color:var(--text-dark)}
  .hint{
    font-size:12px; 
    color:var(--muted); 
    margin-top:4px;
    display:flex;
    align-items:flex-start;
    gap:6px;
  }
  
  input, select{
    width:100%; 
    padding:12px; 
    border-radius:10px; 
    border:2px solid #CFD6DF;
    background:#fff; 
    color:var(--blue-2); 
    font-weight:600;
    font-size:15px;
    transition:all 0.3s ease;
  }
  
  input:focus, select:focus{
    outline:none;
    border-color:var(--terra); 
    box-shadow:0 0 0 3px rgba(217,100,58,.15);
  }
  
  input.success{
    border-color:var(--green);
  }
  
  input.error{
    border-color:#E63B2E;
  }
  
  input:disabled, input[readonly]{
    background:#f0f4f8;
    color:#6b7c8f;
    cursor:not-allowed;
  }

  .field-feedback{
    display:flex;
    align-items:center;
    gap:6px;
    font-size:12px;
    font-weight:700;
    margin-top:4px;
  }
  
  .field-feedback.success{ color:var(--green); }
  .field-feedback.error{ color:#E63B2E; }
  .field-feedback.hidden{ display:none; }

  /* Checkboxes */
  .checks{display:grid; gap:10px; margin:12px 0}
  .checks label{
    display:flex; 
    gap:12px; 
    align-items:flex-start; 
    font-weight:600;
    padding:12px;
    background:rgba(0,59,115,0.03);
    border-radius:8px;
    cursor:pointer;
    transition:background 0.2s ease;
    min-height:52px;
  }
  
  .checks label:hover{
    background:rgba(0,59,115,0.06);
  }
  
  .checks input[type="checkbox"]{
    width:20px;
    height:20px;
    flex-shrink:0;
    margin-top:2px;
    cursor:pointer;
    accent-color:var(--terra);
  }

  /* Buttons */
  .save{
    width:100%; 
    padding:14px; 
    border:none; 
    border-radius:12px; 
    background:var(--terra);
    color:#fff; 
    font-weight:900; 
    font-size:15px;
    letter-spacing:.3px; 
    cursor:pointer;
    box-shadow:0 6px 16px rgba(217,100,58,.25);
    transition:all 0.3s ease;
    position:relative;
  }
  
  .save:hover:not(:disabled){
    background:#c54f29;
    transform:translateY(-2px);
    box-shadow:0 8px 20px rgba(217,100,58,.35);
  }
  
  .save:active:not(:disabled){
    transform:translateY(0);
  }
  
  .save:disabled{
    background:#ccc;
    cursor:not-allowed;
    box-shadow:none;
  }
  
  .save.loading::after{
    content:'';
    position:absolute;
    top:50%;
    right:20px;
    width:18px;
    height:18px;
    margin-top:-9px;
    border:3px solid rgba(255,255,255,0.3);
    border-top-color:#fff;
    border-radius:50%;
    animation:spin 0.8s linear infinite;
  }
  
  @keyframes spin{
    to{ transform:rotate(360deg); }
  }

  .btn{
    padding:12px 20px; 
    border:none; 
    border-radius:10px; 
    background:var(--blue);
    color:#fff; 
    font-weight:700; 
    font-size:14px;
    cursor:pointer;
    transition:all 0.3s ease;
    display:inline-flex;
    align-items:center;
    gap:8px;
  }
  
  .btn:hover:not(:disabled){
    background:var(--blue-2);
    transform:translateY(-2px);
  }
  
  .btn:disabled{
    background:#ccc;
    cursor:not-allowed;
  }
  
  .btn.loading{
    position:relative;
    pointer-events:none;
  }
  
  .btn.loading::after{
    content:'';
    width:14px;
    height:14px;
    border:2px solid rgba(255,255,255,0.3);
    border-top-color:#fff;
    border-radius:50%;
    animation:spin 0.8s linear infinite;
  }

  /* Messages */
  .msg{
    padding:14px 16px; 
    border-radius:12px; 
    font-weight:700;
    margin:16px 0;
    display:flex;
    align-items:center;
    gap:10px;
    animation:slideInDown 0.4s ease;
  }
  
  @keyframes slideInDown{
    from{ opacity:0; transform:translateY(-20px); }
    to{ opacity:1; transform:translateY(0); }
  }
  
  .msg.success{
    background:rgba(14,173,105,0.1);
    color:var(--green);
    border:2px solid var(--green);
  }
  
  .msg.error{
    background:rgba(230,59,46,0.1);
    color:#E63B2E;
    border:2px solid #E63B2E;
  }

  /* Utils */
  .hidden{display:none !important}
  
  .badge-new{
    background:var(--terra);
    color:#fff;
    padding:4px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:900;
    text-transform:uppercase;
    letter-spacing:.5px;
  }

  /* Navigation */
  .nav{
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    background:var(--white);
    border-top:1px solid #E6ECF4;
    display:flex;
    justify-content:space-around;
    align-items:center;
    padding:8px 0;
    box-shadow:0 -4px 12px rgba(0,0,0,.06);
    z-index:10;
  }
  
  .nav a{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:4px;
    text-decoration:none;
    color:var(--muted);
    font-size:24px;
    padding:6px 16px;
    border-radius:10px;
    transition:all 0.2s ease;
    min-width:70px;
  }
  
  .nav a span{
    font-size:11px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:.3px;
  }
  
  .nav a:hover{
    background:rgba(0,59,115,0.05);
  }
  
  .nav a[aria-current="page"]{
    color:var(--terra);
    background:rgba(217,100,58,0.08);
  }

  /* More Menu */
  .more-menu{
    position:fixed;
    bottom:70px;
    right:16px;
    background:var(--white);
    border:1px solid #E6ECF4;
    border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.12);
    padding:8px 0;
    min-width:200px;
    opacity:0;
    transform:translateY(10px) scale(0.95);
    pointer-events:none;
    transition:all 0.3s ease;
    z-index:9;
  }
  
  .more-menu.show{
    opacity:1;
    transform:translateY(0) scale(1);
    pointer-events:auto;
  }
  
  .more-menu a{
    display:flex;
    align-items:center;
    gap:12px;
    padding:12px 16px;
    text-decoration:none;
    color:var(--blue-2);
    font-weight:600;
    font-size:14px;
    transition:background 0.2s ease;
  }
  
  .more-menu a:hover{
    background:rgba(0,59,115,0.05);
  }
  
  .more-menu a span[role="img"]{
    font-size:20px;
  }

  /* Privacy Mode */
  .privacy-card{
    background:linear-gradient(135deg, rgba(14,173,105,0.08), rgba(14,173,105,0.04));
    border:2px solid var(--green);
    border-radius:var(--radius);
    padding:16px;
    margin:16px 0;
  }
  
  .privacy-toggle{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
  }
  
  .toggle-switch{
    position:relative;
    width:52px;
    height:28px;
  }
  
  .toggle-switch input{
    opacity:0;
    width:0;
    height:0;
  }
  
  .toggle-slider{
    position:absolute;
    cursor:pointer;
    top:0;
    left:0;
    right:0;
    bottom:0;
    background:#ccc;
    border-radius:28px;
    transition:0.3s;
  }
  
  .toggle-slider::before{
    position:absolute;
    content:"";
    height:20px;
    width:20px;
    left:4px;
    bottom:4px;
    background:white;
    border-radius:50%;
    transition:0.3s;
  }
  
  .toggle-switch input:checked + .toggle-slider{
    background:var(--green);
  }
  
  .toggle-switch input:checked + .toggle-slider::before{
    transform:translateX(24px);
  }

  /* Consent Cards */
  .consent-card{
    background:var(--white);
    border:2px solid #E6ECF4;
    border-radius:var(--radius);
    padding:16px;
    margin:12px 0;
  }
  
  .consent-card h3{
    margin:0 0 8px;
    font-size:16px;
    color:var(--text-dark);
  }
  
  .consent-card p{
    margin:8px 0;
    color:var(--muted);
    font-size:14px;
    line-height:1.6;
  }

  /* Profile Section */
  .profile-info{
    background:var(--white);
    border:1px solid #E6ECF4;
    border-radius:var(--radius);
    padding:20px;
    margin:16px 0;
  }
  
  .profile-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px 0;
    border-bottom:1px solid #f0f4f8;
  }
  
  .profile-row:last-child{
    border-bottom:none;
  }
  
  .profile-row .label{
    font-weight:700;
    color:var(--muted);
    font-size:13px;
    text-transform:uppercase;
    letter-spacing:.5px;
  }
  
  .profile-row .value{
    font-weight:800;
    color:var(--blue-2);
    font-size:15px;
  }

  /* Network Stats */
  .network-stats{
    display:grid;
    gap:12px;
    margin:16px 0;
  }
  
  .stat-item{
    background:var(--white);
    border:1px solid #E6ECF4;
    border-radius:10px;
    padding:16px;
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  
  .stat-item .label{
    font-weight:700;
    color:var(--muted);
    font-size:14px;
  }
  
  .stat-item .value{
    font-weight:900;
    color:var(--blue-2);
    font-size:24px;
  }

  /* Cases List */
  .cases-list{
    display:grid;
    gap:14px;
    margin:16px 0;
  }
  
  .case-item{
    background:var(--white);
    border:1px solid #E6ECF4;
    border-radius:var(--radius);
    padding:18px;
    transition:all 0.2s ease;
  }
  
  .case-item:hover{
    box-shadow:0 4px 12px rgba(0,0,0,.08);
    border-color:var(--blue);
  }
  
  .case-item-header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    margin-bottom:12px;
    padding-bottom:12px;
    border-bottom:1px solid #f0f4f8;
  }
  
  .case-item-header .pseudonym{
    font-weight:900;
    font-size:16px;
    color:var(--blue-2);
  }
  
  .case-item-header .date{
    font-size:12px;
    color:var(--muted);
    font-weight:600;
  }
  
  .case-item-body{
    display:grid;
    gap:8px;
  }
  
  .case-item-row{
    display:flex;
    gap:8px;
    align-items:center;
    font-size:13px;
  }
  
  .case-item-row .label{
    font-weight:700;
    color:var(--muted);
    min-width:100px;
  }
  
  .case-item-row .value{
    font-weight:600;
    color:var(--text-dark);
  }
  
  .case-item-notes{
    margin-top:8px;
    padding:12px;
    background:rgba(0,59,115,0.03);
    border-radius:8px;
    font-size:13px;
    line-height:1.6;
    color:var(--blue-2);
  }
  
  .case-item-badges{
    display:flex;
    gap:8px;
    margin-top:12px;
    flex-wrap:wrap;
  }
  
  .case-badge{
    padding:4px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:800;
    text-transform:uppercase;
    letter-spacing:.5px;
  }
  
  .case-badge.anon{
    background:rgba(14,173,105,0.1);
    color:var(--green);
    border:1px solid var(--green);
  }
  
  .case-badge.federated{
    background:rgba(0,59,115,0.08);
    color:var(--blue);
    border:1px solid var(--blue);
  }

  /* Responsive */
  @media (max-width: 640px) {
    .kpi-grid{
      grid-template-columns:1fr 1fr;
    }
    
    .fab{
      width:56px;
      height:56px;
      font-size:24px;
    }
  }
</style>
</head>
<body>

<header class="eban-header">
  <div class="header-logo">
    <img src="Logo.png" alt="ÉBAN - Símbolo Adinkra de Cuidado" style="height: 32px; width: auto; margin-right: 12px;" />
    <div>
      <h1>ÉBAN Blueprint</h1>
      <p>Ethical Social Tech for Care Networks</p>
    </div>
  </div>
</header>

<main>
  <!-- DASHBOARD -->
  <section id="dashboard">
    <div class="section-header">
      <div class="title">
        <span role="img" aria-label="chart">📊</span>
        Community Care Records
      </div>
      <div class="subtitle">Supporting our community with dignity and care</div>
    </div>

    <div class="kpi-grid">
      <div class="card">
        <div class="kpi">
          <div class="label">People Supported</div>
          <div class="value" id="valLocalCases">48</div>
          <div class="sub">Individuals welcomed and assisted</div>
        </div>
      </div>

      <div class="card">
        <div class="kpi badge" data-badge="GOAL">
          <div class="label">Consent Rate</div>
          <div class="value" id="valLocalConsent">96%</div>
          <div class="sub">Built on trust and transparency</div>
        </div>
      </div>

      <div class="card">
        <div class="kpi">
          <div class="label">Privacy Protected</div>
          <div class="value" id="valLocalAnon">12</div>
          <div class="sub">Identities safeguarded with care</div>
        </div>
      </div>
    </div>

    <div class="section-header network">
      <div class="title">
        <span role="img" aria-label="globe">🌍</span>
        Collective Impact
      </div>
      <div class="subtitle">Together, we're building a more caring world</div>
    </div>

    <div class="kpi-grid">
      <div class="card">
        <div class="kpi">
          <div class="label">Shared Insights</div>
          <div class="value" id="valNetContrib">19</div>
          <div class="sub">Contributing to collective learning</div>
        </div>
      </div>
    </div>
  </section>

  <!-- NEW CASE -->
  <section id="newCase" class="hidden">
    <h2>
      <span role="img" aria-label="new">🤝</span>
      Welcome a New Person
    </h2>

    <div class="msg success hidden" id="msgOK">
      <span role="img" aria-label="check">✓</span>
      Person's journey documented with care and respect!
    </div>

    <form class="form card" id="caseForm" onsubmit="saveCase(event)">
      <div class="row">
        <label for="techName">
          Your Name (Care Provider) <span style="color:var(--terra)">*</span>
        </label>
        <input 
          type="text" 
          id="techName" 
          placeholder="e.g., Maria Silva"
          oninput="validateForm()"
          required
          aria-required="true"
        />
        <div class="field-feedback hidden" id="techName-feedback"></div>
      </div>

      <div class="row">
        <label for="personName">Person's Name (Optional)</label>
        <input 
          type="text" 
          id="personName" 
          placeholder="e.g., João Santos"
          oninput="validateForm()"
        />
        <div class="hint">
          <span>💫</span>
          <span>We'll create a respectful pseudonym to protect their privacy</span>
        </div>
      </div>

      <div class="row">
        <label for="pseudonym">Protected Identity Code</label>
        <input 
          type="text" 
          id="pseudonym" 
          placeholder="Generated automatically with care"
          readonly
          aria-readonly="true"
        />
      </div>

      <div class="row">
        <label for="supportType">
          Type of Support Provided <span style="color:var(--terra)">*</span>
        </label>
        <select 
          id="supportType" 
          onchange="validateForm()"
          required
          aria-required="true"
        >
          <option value="">Choose the support offered...</option>
          <option value="psychological">Emotional & Psychological Care</option>
          <option value="legal">Legal Support & Advocacy</option>
          <option value="medical">Health & Medical Care</option>
          <option value="social">Social Services & Resources</option>
          <option value="other">Other Forms of Support</option>
        </select>
        <div class="field-feedback hidden" id="supportType-feedback"></div>
      </div>

      <div class="row">
        <label for="caseNotes">Session Notes & Reflections</label>
        <textarea 
          id="caseNotes" 
          placeholder="Share context about this person's journey and the support provided..."
          rows="4"
          style="width:100%; padding:12px; border-radius:10px; border:2px solid #CFD6DF; background:#fff; color:var(--blue-2); font-weight:600; font-size:15px; font-family:inherit; resize:vertical; transition:all 0.3s ease;"
        ></textarea>
        <div class="hint">
          <span>💭</span>
          <span>Optional: Document this moment to honor their story and support continuity of care</span>
        </div>
      </div>

      <div class="checks">
        <label>
          <input type="checkbox" id="consentLocal" onchange="validateForm()" required aria-required="true" />
          <span>
            <strong>🤝 Informed consent obtained</strong> (Required)<br>
            <small style="color:var(--muted)">This person understands and agrees to how we'll care for their information</small>
          </span>
        </label>

        <label>
          <input type="checkbox" id="consentFederated" />
          <span>
            <strong>🌍 Permission to share anonymously</strong> (Optional)<br>
            <small style="color:var(--muted)">Help improve support for others while keeping this person's identity completely private</small>
          </span>
        </label>

        <label>
          <input type="checkbox" id="anon" />
          <span>
            <strong>🕊️ Maximum privacy protection</strong><br>
            <small style="color:var(--muted)">Store absolutely no identifying information — full anonymity</small>
          </span>
        </label>
      </div>

      <button 
        type="submit" 
        class="save" 
        id="btnSave" 
        disabled 
        aria-disabled="true"
      >
        Honor Their Story
      </button>
    </form>
  </section>

  <!-- CASE HISTORY -->
  <section id="caseHistory" class="hidden">
    <h2>
      <span role="img" aria-label="history">📖</span>
      Stories of Care & Support
    </h2>

    <div class="section-header">
      <div class="title">
        <span role="img" aria-label="list">💫</span>
        Journey Together
      </div>
      <div class="subtitle">Honoring every person's path and the care we've shared</div>
    </div>

    <div id="casesList" class="cases-list">
      <div class="card" style="text-align:center; padding:40px; color:var(--muted)">
        <span style="font-size:48px">🌱</span>
        <p style="margin:16px 0 0">No stories documented yet.</p>
        <p style="font-size:13px">Begin by welcoming someone — click the 🤝 button above.</p>
      </div>
    </div>
  </section>

  <!-- CONSENT -->
  <section id="consent" class="hidden">
    <h2>
      <span role="img" aria-label="lock">🤝</span>
      Consent & Trust
    </h2>

    <div class="consent-card">
      <h3>💙 Supporting You Locally</h3>
      <p>
        <strong>Why we keep records:</strong> To provide you with continuous, personalized care and improve how we support our community.
      </p>
      <p>
        <strong>How long we keep them:</strong> Typically 5-7 years, following ethical guidelines that protect your story.
      </p>
      <p>
        <strong>Your rights, always:</strong> You can see, correct, or ask us to delete your information at any time. Your autonomy matters.
      </p>
      <button class="btn" onclick="signConsent(event)">
        <span>✍🏾</span>
        Sign with Understanding
      </button>
    </div>

    <div class="consent-card" style="border-color:var(--green)">
      <h3>🌍 Growing Together, Globally</h3>
      <p>
        <strong>Building collective wisdom:</strong> With your permission, we can share anonymized patterns (never your personal story) to help support organizations everywhere learn and improve.
      </p>
      <p>
        <strong>What we share:</strong> Only anonymous insights — statistical patterns that help us all do better. Never individual details or identities.
      </p>
      <p>
        <strong>Privacy guaranteed:</strong> Advanced privacy technology ensures your identity is completely protected. You remain invisible in the data.
      </p>
      <button class="btn" onclick="signConsent(event)">
        <span>✍🏾</span>
        Join Our Collective Learning
      </button>
    </div>
  </section>

  <!-- NETWORK -->
  <section id="network" class="hidden">
    <h2>
      <span role="img" aria-label="network">🌍</span>
      Our Collective Impact
    </h2>

    <div class="section-header network">
      <div class="title">Your Community's Contribution</div>
    </div>

    <div class="network-stats">
      <div class="stat-item">
        <div class="label">Stories Shared Anonymously</div>
        <div class="value" id="netThisOrg">19</div>
      </div>
      <div class="stat-item">
        <div class="label">Communities Connected</div>
        <div class="value">47</div>
      </div>
      <div class="stat-item">
        <div class="label">Collective Insights</div>
        <div class="value">2,341</div>
      </div>
    </div>

    <div class="card" style="margin-top:20px">
      <h3 style="margin-top:0">🌱 How We Learn Together</h3>
      <p style="color:var(--muted); line-height:1.7">
        Our network uses privacy-first technology to generate insights without ever sharing personal stories. 
        Each community teaches its own local patterns, and only the lessons learned (never the raw data) 
        are shared to help us all understand and serve better — while keeping every individual's identity 
        completely protected and sacred.
      </p>
      <p style="color:var(--blue-2); line-height:1.7; margin-top:16px; font-weight:600">
        💙 Together, we're building a more caring, evidence-informed world — one protected story at a time.
      </p>
    </div>
  </section>

  <!-- PRIVACY MODE -->
  <section id="privacy" class="hidden">
    <h2>
      <span role="img" aria-label="shield">🛡️</span>
      Privacy Shield
    </h2>

    <div class="privacy-card">
      <div class="privacy-toggle">
        <div>
          <strong>💫 Protective Display Mode</strong>
          <div style="font-size:13px; color:var(--muted); margin-top:4px" id="privacyText">
            Normal mode active — full transparency for you.
          </div>
        </div>
        <label class="toggle-switch">
          <input 
            type="checkbox" 
            id="privacyToggle" 
            onchange="togglePrivacy(this)"
            role="switch"
            aria-checked="false"
          />
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>

    <div class="card">
      <h3 style="margin-top:0">🕶️ What Privacy Shield Does</h3>
      <ul style="color:var(--muted); line-height:1.8">
        <li>Masks sensitive information on your screen when others might see</li>
        <li>Protects names and numbers from casual viewing</li>
        <li>Perfect for working in shared or public spaces</li>
        <li>Your data stays fully secure regardless — this just changes what's visible</li>
      </ul>
      <p style="color:var(--muted); margin-top:16px; font-size:13px">
        <strong>💙 Remember:</strong> This is a display feature only. All information remains 
        encrypted and protected at all times, whether this shield is on or off.
      </p>
    </div>
  </section>

  <!-- PROFILE -->
  <section id="profile" class="hidden">
    <h2>
      <span role="img" aria-label="user">👤</span>
      Your Care Journey
    </h2>

    <div class="profile-info">
      <div class="profile-row">
        <div class="label">Care Provider</div>
        <div class="value" id="profName">—</div>
      </div>
      <div class="profile-row">
        <div class="label">Your Code</div>
        <div class="value" id="profCode">—</div>
      </div>
      <div class="profile-row">
        <div class="label">People Supported</div>
        <div class="value">48</div>
      </div>
      <div class="profile-row">
        <div class="label">Collective Contributions</div>
        <div class="value" id="profNet">19</div>
      </div>
      <div class="profile-row">
        <div class="label">Privacy-Protected Stories</div>
        <div class="value" id="profAnon">12</div>
      </div>
    </div>

    <button class="btn" onclick="resetDemo()" style="width:100%; margin-top:16px">
      <span>🔄</span>
      Reset Demo Data
    </button>
  </section>
</main>

<button class="fab" onclick="showScreen('newCase')" aria-label="Add new case">
  ➕
</button>

<nav class="nav" role="navigation" aria-label="Main navigation">
  <a href="#" aria-label="Dashboard" onclick="showScreen('dashboard');event.preventDefault()" aria-current="page">
    📊
    <span>Overview</span>
  </a>
  <a href="#" aria-label="Welcome someone" onclick="showScreen('newCase');event.preventDefault()">
    🤝
    <span>Welcome</span>
  </a>
  <a href="#" aria-label="Care stories" onclick="showScreen('caseHistory');event.preventDefault()">
    📖
    <span>Stories</span>
  </a>
  <a href="#" aria-label="Our impact" onclick="showScreen('network');event.preventDefault()">
    🌍
    <span>Impact</span>
  </a>
  <a href="#" aria-label="More options" onclick="toggleMoreMenu();event.preventDefault()" id="moreBtn">
    ⋮
    <span>More</span>
  </a>
</nav>

<div class="more-menu" id="moreMenu">
  <a href="#" onclick="showScreen('consent');toggleMoreMenu();event.preventDefault()">
    <span role="img" aria-label="Consent">🤝</span>
    Trust & Consent
  </a>
  <a href="#" onclick="showScreen('privacy');toggleMoreMenu();event.preventDefault()">
    <span role="img" aria-label="Privacy">🛡️</span>
    Privacy Shield
  </a>
  <a href="#" onclick="showScreen('profile');toggleMoreMenu();event.preventDefault()">
    <span role="img" aria-label="Profile">💫</span>
    Your Journey
  </a>
</div>

<script>
  // STORAGE EM MEMÓRIA
  let appState = {
    local: { cases: 48, consent: 46, anon: 12 },
    net: { contrib: 19 },
    people: [],
    cases: [], // Array completo de casos com histórico
    techName: '',
    techCode: ''
  };

  // GERAÇÃO DE CÓDIGOS
  function randUUID(){
    return (Math.random().toString(16).slice(2) + Date.now().toString(16)).toUpperCase();
  }
  
  function genTechCode(){ 
    return 'EB-' + randUUID().slice(0,8); 
  }
  
  function genPseudonym(name){
    const base = (name || 'AN').trim().toUpperCase().slice(0,2);
    const salt = Math.floor(Math.random() * 255).toString(16).padStart(2, '0');
    const timestamp = (Date.now() % 10000).toString(16).padStart(4, '0');
    return `BEN-${base}-${timestamp}-${salt}`.toUpperCase();
  }

  // NAVEGAÇÃO
  function showScreen(id){
    document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
    const targetSection = document.getElementById(id);
    if (targetSection) {
      targetSection.classList.remove('hidden');
    }
    updateNav(id);
    window.scrollTo({ top: 0, behavior: 'smooth' });
    
    // Fecha more menu se aberto
    const moreMenu = document.getElementById('moreMenu');
    if (moreMenu) {
      moreMenu.classList.remove('show');
    }
  }

  function updateNav(id){
    const links = [...document.querySelectorAll('.nav a')];
    links.forEach(l => l.removeAttribute('aria-current'));
    const map = {dashboard:0, newCase:1, caseHistory:2, network:3};
    if (map[id] != null && links[map[id]]) {
      links[map[id]].setAttribute('aria-current', 'page');
    }
  }

  function toggleMoreMenu(){
    const menu = document.getElementById('moreMenu');
    if (menu) {
      menu.classList.toggle('show');
    }
  }

  // Fecha more menu ao clicar fora
  document.addEventListener('click', (e) => {
    const menu = document.getElementById('moreMenu');
    const btn = document.getElementById('moreBtn');
    if (menu && btn && !menu.contains(e.target) && !btn.contains(e.target)){
      menu.classList.remove('show');
    }
  });

  // RENDER KPIs
  function render(mask = false){
    const L = appState.local;
    const N = appState.net;
    const consentPct = L.cases ? Math.round((L.consent / L.cases) * 100) : 0;

    const vCases = mask ? '••' : String(L.cases);
    const vConsent = mask ? '••%' : `${consentPct}%`;
    const vAnon = mask ? '••' : String(L.anon);
    const vNet = mask ? '••' : String(N.contrib);

    const elements = {
      'valLocalCases': vCases,
      'valLocalConsent': vConsent,
      'valLocalAnon': vAnon,
      'valNetContrib': vNet,
      'netThisOrg': vNet,
      'profNet': mask ? '••' : (N.contrib || 0),
      'profAnon': mask ? '••' : (L.anon || 0)
    };

    Object.keys(elements).forEach(id => {
      const el = document.getElementById(id);
      if (el) {
        el.textContent = elements[id];
      }
    });
  }

  // VALIDAÇÃO DE FORM
  function validateForm(){
    const tech = document.getElementById('techName').value.trim();
    const person = document.getElementById('personName').value.trim();
    const type = document.getElementById('supportType').value;
    const cLocal = document.getElementById('consentLocal').checked;

    // Feedback inline
    const techFeedback = document.getElementById('techName-feedback');
    const techInput = document.getElementById('techName');
    if (techFeedback && techInput) {
      if (tech){
        techFeedback.textContent = '✓ Thank you';
        techFeedback.className = 'field-feedback success';
        techInput.classList.add('success');
        techInput.classList.remove('error');
      } else {
        techFeedback.textContent = '💙 Please share your name so we know who's providing care';
        techFeedback.className = 'field-feedback error';
        techInput.classList.add('error');
        techInput.classList.remove('success');
      }
    }

    const typeFeedback = document.getElementById('supportType-feedback');
    const typeInput = document.getElementById('supportType');
    if (typeFeedback && typeInput) {
      if (type){
        typeFeedback.textContent = '✓ Wonderful';
        typeFeedback.className = 'field-feedback success';
        typeInput.classList.add('success');
        typeInput.classList.remove('error');
      } else {
        typeFeedback.textContent = '💙 Help us understand what kind of support you're offering';
        typeFeedback.className = 'field-feedback error';
        typeInput.classList.add('error');
        typeInput.classList.remove('success');
      }
    }

    // Gera pseudónimo se tiver nome
    const pseudonymInput = document.getElementById('pseudonym');
    if (person && pseudonymInput && !pseudonymInput.value){
      pseudonymInput.value = genPseudonym(person);
    }

    const ok = tech && type && cLocal;
    const btnSave = document.getElementById('btnSave');
    if (btnSave) {
      btnSave.disabled = !ok;
      btnSave.setAttribute('aria-disabled', String(!ok));
    }
  }

  // SALVAR CASO
  function saveCase(event){
    event.preventDefault();
    
    const tech = document.getElementById('techName').value.trim();
    const person = document.getElementById('personName').value.trim();
    const pseudonymInput = document.getElementById('pseudonym');
    const pseud = pseudonymInput ? (pseudonymInput.value.trim() || genPseudonym(person || 'Anonymous')) : genPseudonym(person || 'Anonymous');
    const type = document.getElementById('supportType').value;
    const notes = document.getElementById('caseNotes') ? document.getElementById('caseNotes').value.trim() : '';
    const cLocal = document.getElementById('consentLocal').checked;
    const cFed = document.getElementById('consentFederated').checked;
    const anon = document.getElementById('anon').checked;

    if (!tech || !type || !cLocal){ 
      alert('💙 Just a gentle reminder: Please complete the required fields so we can honor this person\'s story properly.');
      return;
    }

    const btnSave = document.getElementById('btnSave');
    if (btnSave) {
      btnSave.classList.add('loading');
      btnSave.disabled = true;
    }

    setTimeout(() => {
      // Gera código técnico se não existir
      if (!appState.techCode){
        appState.techCode = genTechCode();
      }
      appState.techName = tech;

      // Cria objeto completo do caso
      const caseObj = {
        id: Date.now(),
        pseud: pseud,
        person: person || 'Anonymous',
        type: type,
        notes: notes,
        technician: tech,
        date: new Date().toISOString(),
        anon: anon,
        federated: cFed,
        localConsent: cLocal
      };

      // Atualiza estado
      if (!appState.people.find(p => p.pseud === pseud)){
        appState.people.push({pseud, person: person || 'Anonymous', type});
        appState.local.cases += 1;
        appState.local.consent += 1;
        if (anon) appState.local.anon += 1;
        if (cFed) appState.net.contrib += 1;
      }

      // Adiciona ao histórico completo
      appState.cases.unshift(caseObj); // Adiciona no início para mostrar os mais recentes primeiro

      // Atualiza perfil
      const profName = document.getElementById('profName');
      const profCode = document.getElementById('profCode');
      if (profName) profName.textContent = tech;
      if (profCode) profCode.textContent = appState.techCode;

      // Renderiza
      const privacyToggle = document.getElementById('privacyToggle');
      render(privacyToggle ? privacyToggle.checked : false);
      renderCasesList(); // Nova função para renderizar lista de casos

      // Remove loading
      if (btnSave) {
        btnSave.classList.remove('loading');
      }
      
      // Mostra sucesso
      const msg = document.getElementById('msgOK');
      if (msg) {
        msg.classList.remove('hidden');
      }

      setTimeout(() => {
        if (msg) {
          msg.classList.add('hidden');
        }
        showScreen('caseHistory'); // Mostra o histórico após salvar
        
        // Reset form
        const form = document.getElementById('caseForm');
        if (form) {
          form.reset();
        }
        document.querySelectorAll('.field-feedback').forEach(el => el.className = 'field-feedback hidden');
        document.querySelectorAll('input, select').forEach(el => {
          el.classList.remove('error', 'success');
        });
        validateForm();
      }, 2500);
    }, 1500);
  }

  // ASSINAR CONSENTIMENTO
  function signConsent(event){
    const btn = event ? event.target : null;
    if (btn) {
      btn.classList.add('loading');
      btn.disabled = true;

      setTimeout(() => {
        btn.classList.remove('loading');
        btn.disabled = false;
        alert('✓ Thank you for your trust. Consent recorded with care and transparency on ' + new Date().toLocaleString() + '. 💙');
      }, 1200);
    }
  }

  // PRIVACY TOGGLE
  function togglePrivacy(el){
    if (!el) return;
    
    const mask = el.checked;
    const msg = document.getElementById('privacyText');
    const profName = document.getElementById('profName');
    
    if (msg) {
      if (mask){
        msg.textContent = '🛡️ Privacy Shield ON: Information protected from view while you work.';
        msg.style.color = 'var(--green)';
        if (profName) profName.textContent = 'Protected';
      } else {
        msg.textContent = 'Normal mode active — full transparency for you.';
        msg.style.color = 'var(--blue-2)';
        if (profName) profName.textContent = appState.techName || '—';
      }
    }
    
    render(mask);
    el.setAttribute('aria-checked', String(mask));
  }

  // RENDERIZAR LISTA DE CASOS
  function renderCasesList(){
    const container = document.getElementById('casesList');
    if (!container) return;

    if (appState.cases.length === 0) {
      container.innerHTML = `
        <div class="card" style="text-align:center; padding:40px; color:var(--muted)">
          <span style="font-size:48px">📭</span>
          <p style="margin:16px 0 0">No cases registered yet.</p>
          <p style="font-size:13px">Start by clicking the ➕ button to register your first case.</p>
        </div>
      `;
      return;
    }

    let html = '';
    appState.cases.forEach(c => {
      const date = new Date(c.date);
      const dateStr = date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });

      const typeLabels = {
        psychological: 'Emotional & Psychological Care',
        legal: 'Legal Support & Advocacy',
        medical: 'Health & Medical Care',
        social: 'Social Services & Resources',
        other: 'Other Forms of Support'
      };

      html += `
        <div class="case-item">
          <div class="case-item-header">
            <div class="pseudonym">${c.pseud}</div>
            <div class="date">${dateStr}</div>
          </div>
          <div class="case-item-body">
            <div class="case-item-row">
              <span class="label">Care Provided:</span>
              <span class="value">${typeLabels[c.type] || c.type}</span>
            </div>
            <div class="case-item-row">
              <span class="label">Supported by:</span>
              <span class="value">${c.technician}</span>
            </div>
            ${c.notes ? `
              <div class="case-item-notes">
                <strong>💭 Reflections:</strong><br>
                ${c.notes}
              </div>
            ` : ''}
          </div>
          <div class="case-item-badges">
            ${c.anon ? '<span class="case-badge anon">🕊️ Privacy Protected</span>' : ''}
            ${c.federated ? '<span class="case-badge federated">🌍 Shared Anonymously</span>' : ''}
            ${c.localConsent ? '<span class="case-badge" style="background:rgba(14,173,105,0.1); color:var(--green); border:1px solid var(--green)">✓ Trusted</span>' : ''}
          </div>
        </div>
      `;
    });

    container.innerHTML = html;
  }

  // RESET DEMO
  function resetDemo(){
    if (confirm('Are you sure you want to clear all demonstration data? This will start fresh. 🌱')){
      appState = {
        local: { cases: 48, consent: 46, anon: 12 },
        net: { contrib: 19 },
        people: [],
        cases: [],
        techName: '',
        techCode: ''
      };
      const privacyToggle = document.getElementById('privacyToggle');
      render(privacyToggle ? privacyToggle.checked : false);
      renderCasesList();
      
      const profName = document.getElementById('profName');
      const profCode = document.getElementById('profCode');
      if (profName) profName.textContent = '—';
      if (profCode) profCode.textContent = '—';
      
      alert('✨ Demo data cleared. Ready for a fresh start!');
    }
  }

  // BOOT
  window.addEventListener('load', () => {
    const techNameInput = document.getElementById('techName');
    const profName = document.getElementById('profName');
    const profCode = document.getElementById('profCode');
    
    if (appState.techName && appState.techCode){
      if (techNameInput) techNameInput.value = appState.techName;
      if (profName) profName.textContent = appState.techName;
      if (profCode) profCode.textContent = appState.techCode;
    }
    render(false);
    renderCasesList();
    showScreen('dashboard');
  });
</script>

</body>
</html>
