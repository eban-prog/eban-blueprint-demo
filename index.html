<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#003B73" />
<title>√âBAN Blueprint ‚Äî Making care visible through ethical data</title>
<style>
  :root{
    --blue:#003B73;
    --blue-2:#0B2A4A;
    --navy:#002B5A;
    --terra:#D9643A;
    --terra-100:#FFE7DC;
    --green:#0EAD69;
    --bg:#F5F8FC;
    --white:#FFFFFF;
    --muted:#4a5a6c;
    --text-dark:#1a3a5a;
    --radius:14px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--blue-2);
    font:15.5px/1.55 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    padding-bottom:80px;
  }

  /* Header */
  .eban-header{
    background:linear-gradient(180deg, var(--navy), #053566); 
    color:#fff; padding:18px 16px; text-align:center; 
    position:sticky; top:0; z-index:3; 
    box-shadow:0 6px 18px rgba(0,0,0,.08)
  }
  .header-logo{
    display:flex;
    align-items:center;
    justify-content:center;
    gap:12px;
  }
  .header-logo img{
    height:40px;
    width:auto;
    filter:brightness(0) invert(1);
    object-fit:contain;
  }
  .header-logo div{
    text-align:left;
  }
  .eban-header h1{margin:0 0 4px; font-size:20px; letter-spacing:.3px}
  .eban-header p{margin:0; opacity:.9; font-weight:600; font-size:13.5px}

  main{padding:16px; max-width:980px; margin:0 auto}
  h2{margin:8px 0 14px; font-size:20px; letter-spacing:.2px; display:flex; align-items:center; gap:8px}

  /* Section Headers */
  .section-header{
    background:linear-gradient(135deg, rgba(0,59,115,0.08), rgba(0,59,115,0.04));
    border-left:4px solid var(--blue);
    padding:12px 16px;
    border-radius:10px;
    margin:16px 0 12px;
  }
  .section-header .title{
    font-weight:800; 
    color:var(--text-dark); 
    font-size:15px;
    letter-spacing:.3px;
    text-transform:uppercase;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .section-header .subtitle{
    font-size:13px;
    color:var(--muted);
    margin-top:4px;
  }

  .section-header.network{
    background:linear-gradient(135deg, rgba(14,173,105,0.08), rgba(14,173,105,0.04));
    border-left-color:var(--green);
  }

  /* Cards / KPIs */
  .kpi-grid{
    display:grid; 
    gap:14px; 
    grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
    animation:fadeInUp 0.5s ease;
  }
  
  @keyframes fadeInUp {
    from { opacity:0; transform:translateY(20px); }
    to { opacity:1; transform:translateY(0); }
  }

  .card{
    background:var(--white); 
    border:1px solid #E6ECF4; 
    border-radius:var(--radius);
    padding:16px 14px; 
    box-shadow:0 4px 12px rgba(0,0,0,.05);
    transition:transform 0.2s ease, box-shadow 0.2s ease;
  }
  
  .card:hover{
    box-shadow:0 6px 16px rgba(0,0,0,.08);
  }

  .kpi{
    display:flex; 
    flex-direction:column; 
    gap:8px; 
    min-height:118px; 
    position:relative;
  }
  
  .kpi .label{
    font-weight:800; 
    font-size:13px; 
    color:#2a4564; 
    text-transform:uppercase; 
    letter-spacing:.4px;
  }
  
  .kpi .value{
    font-size:32px; 
    font-weight:900; 
    color:var(--blue-2);
    font-variant-numeric:tabular-nums;
  }
  
  .kpi .sub{
    font-size:12.5px; 
    color:var(--muted);
    margin-top:auto;
  }
  
  .kpi.badge::before{
    content:attr(data-badge); 
    position:absolute; 
    top:10px; 
    right:10px;
    background:var(--terra-100); 
    color:#9a3d23; 
    border:1px solid #f1b39e;
    padding:3px 10px; 
    border-radius:999px; 
    font-weight:800; 
    font-size:10px;
    text-transform:uppercase;
    letter-spacing:.5px;
  }

  /* FAB */
  .fab{
    position:fixed; 
    right:20px; 
    bottom:90px;
    background:var(--terra); 
    color:#fff; 
    width:60px; 
    height:60px; 
    border-radius:50%;
    border:none; 
    box-shadow:0 8px 20px rgba(217,100,58,.3);
    font-size:28px; 
    cursor:pointer; 
    display:grid; 
    place-items:center;
    transition:all 0.3s ease;
    z-index:2;
  }
  
  .fab:hover{
    background:#c54f29;
    transform:scale(1.1);
    box-shadow:0 10px 24px rgba(217,100,58,.4);
  }
  
  .fab:active{
    transform:scale(0.95);
  }
  
  .fab:focus-visible{
    outline:3px solid #fff; 
    outline-offset:3px;
  }

  /* Form */
  .form .row{display:grid; gap:10px; margin-bottom:14px}
  .form label{font-weight:800; font-size:13.5px; color:var(--text-dark)}
  .hint{
    font-size:12px; 
    color:var(--muted); 
    margin-top:4px;
    display:flex;
    align-items:flex-start;
    gap:6px;
  }
  
  input, select, textarea{
    width:100%; 
    padding:12px; 
    border-radius:10px; 
    border:2px solid #CFD6DF;
    background:#fff; 
    color:var(--blue-2); 
    font-weight:600;
    font-size:15px;
    transition:all 0.3s ease;
    font-family:inherit;
  }
  
  textarea{
    min-height:100px;
    resize:vertical;
  }
  
  input:focus, select:focus, textarea:focus{
    outline:none;
    border-color:var(--terra); 
    box-shadow:0 0 0 3px rgba(217,100,58,.15);
  }
  
  input.success, select.success{
    border-color:var(--green);
  }
  
  input.error, select.error{
    border-color:#E63B2E;
  }
  
  input:disabled, input[readonly]{
    background:#f0f4f8;
    color:#6b7c8f;
    cursor:not-allowed;
  }

  .field-feedback{
    display:flex;
    align-items:center;
    gap:6px;
    font-size:12px;
    font-weight:700;
    margin-top:4px;
  }
  
  .field-feedback.success{ color:var(--green); }
  .field-feedback.error{ color:#E63B2E; }
  .field-feedback.hidden{ display:none; }

  /* Checkboxes */
  .checks{display:grid; gap:10px; margin:12px 0}
  .checks label{
    display:flex; 
    gap:12px; 
    align-items:flex-start; 
    font-weight:600;
    padding:12px;
    background:rgba(0,59,115,0.03);
    border-radius:8px;
    cursor:pointer;
    transition:background 0.2s ease;
    min-height:52px;
  }
  
  .checks label:hover{
    background:rgba(0,59,115,0.06);
  }
  
  .checks input[type="checkbox"]{
    width:20px;
    height:20px;
    flex-shrink:0;
    margin-top:2px;
    cursor:pointer;
    accent-color:var(--terra);
  }

  /* Buttons */
  .save{
    width:100%; 
    padding:14px; 
    border:none; 
    border-radius:12px; 
    background:var(--terra);
    color:#fff; 
    font-weight:900; 
    font-size:15px;
    letter-spacing:.3px; 
    cursor:pointer;
    box-shadow:0 6px 16px rgba(217,100,58,.25);
    transition:all 0.3s ease;
    position:relative;
    overflow:hidden;
  }
  
  .save:hover:not(:disabled){
    background:#c54f29;
    box-shadow:0 8px 20px rgba(217,100,58,.35);
    transform:translateY(-2px);
  }
  
  .save:active:not(:disabled){
    transform:translateY(0);
  }
  
  .save:disabled{
    background:#ccc;
    cursor:not-allowed;
    box-shadow:none;
  }
  
  .save.loading{
    pointer-events:none;
  }
  
  .save.loading::after{
    content:'';
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
    animation:loading 1.5s infinite;
  }
  
  @keyframes loading{
    0%{ transform:translateX(-100%); }
    100%{ transform:translateX(100%); }
  }

  .btn-sec{
    background:var(--blue-2);
    border:2px solid var(--blue);
  }
  
  .btn-sec:hover:not(:disabled){
    background:var(--blue);
  }

  /* Success Message */
  .msg-ok{
    position:fixed;
    bottom:100px;
    left:50%;
    transform:translateX(-50%);
    background:var(--green);
    color:#fff;
    padding:16px 24px;
    border-radius:12px;
    box-shadow:0 8px 24px rgba(14,173,105,.3);
    font-weight:900;
    z-index:100;
    animation:slideUp 0.4s ease;
  }
  
  @keyframes slideUp{
    from{ opacity:0; transform:translate(-50%, 20px); }
    to{ opacity:1; transform:translate(-50%, 0); }
  }
  
  .msg-ok.hidden{
    display:none;
  }

  /* Privacy Toggle */
  .privacy-toggle{
    display:flex;
    align-items:center;
    gap:12px;
    padding:14px;
    background:rgba(0,59,115,0.04);
    border-radius:10px;
    margin:12px 0;
  }
  
  .privacy-toggle input[type="checkbox"]{
    width:48px;
    height:26px;
    appearance:none;
    background:#ccc;
    border-radius:13px;
    position:relative;
    cursor:pointer;
    transition:background 0.3s ease;
  }
  
  .privacy-toggle input[type="checkbox"]::before{
    content:'';
    position:absolute;
    width:20px;
    height:20px;
    border-radius:50%;
    background:#fff;
    top:3px;
    left:3px;
    transition:left 0.3s ease;
  }
  
  .privacy-toggle input[type="checkbox"]:checked{
    background:var(--green);
  }
  
  .privacy-toggle input[type="checkbox"]:checked::before{
    left:25px;
  }

  /* Hidden utility */
  .hidden{
    display:none !important;
  }

  /* Navigation */
  .nav{
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    background:var(--white);
    display:grid;
    grid-template-columns:repeat(5, 1fr);
    border-top:1px solid #E6ECF4;
    z-index:10;
    box-shadow:0 -4px 12px rgba(0,0,0,.08);
  }
  
  .nav a{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:4px;
    padding:12px 8px;
    text-decoration:none;
    color:var(--muted);
    font-size:22px;
    transition:all 0.2s ease;
    position:relative;
  }
  
  .nav a span{
    font-size:11px;
    font-weight:700;
    text-transform:uppercase;
    letter-spacing:.5px;
  }
  
  .nav a:hover{
    background:rgba(0,59,115,0.04);
  }
  
  .nav a[aria-current="page"]{
    color:var(--terra);
    background:rgba(217,100,58,0.08);
  }
  
  .nav a[aria-current="page"]::before{
    content:'';
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:3px;
    background:var(--terra);
    border-radius:0 0 3px 3px;
  }

  /* More Menu */
  .more-menu{
    position:fixed;
    bottom:80px;
    right:20px;
    background:var(--white);
    border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,.15);
    padding:8px;
    min-width:200px;
    display:none;
    z-index:11;
    animation:fadeIn 0.2s ease;
  }
  
  @keyframes fadeIn{
    from{ opacity:0; transform:translateY(10px); }
    to{ opacity:1; transform:translateY(0); }
  }
  
  .more-menu.show{
    display:block;
  }
  
  .more-menu a{
    display:flex;
    align-items:center;
    gap:12px;
    padding:12px;
    text-decoration:none;
    color:var(--blue-2);
    font-weight:600;
    border-radius:8px;
    transition:background 0.2s ease;
  }
  
  .more-menu a:hover{
    background:rgba(0,59,115,0.06);
  }
  
  .more-menu a span{
    font-size:20px;
  }

  /* Case History Styles */
  .case-item{
    background:var(--white);
    border:1px solid #E6ECF4;
    border-radius:var(--radius);
    padding:16px;
    margin-bottom:14px;
    box-shadow:0 4px 12px rgba(0,0,0,.05);
    transition:box-shadow 0.2s ease;
  }
  
  .case-item:hover{
    box-shadow:0 6px 16px rgba(0,0,0,.08);
  }
  
  .case-item-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:12px;
    padding-bottom:12px;
    border-bottom:2px solid #E6ECF4;
  }
  
  .case-item-header .pseudonym{
    font-weight:900;
    font-size:16px;
    color:var(--blue);
    letter-spacing:.3px;
  }
  
  .case-item-header .date{
    font-size:12px;
    color:var(--muted);
    font-weight:600;
  }
  
  .case-item-body{
    display:grid;
    gap:8px;
  }
  
  .case-item-row{
    display:grid;
    grid-template-columns:140px 1fr;
    gap:8px;
    align-items:start;
  }
  
  .case-item-row .label{
    font-weight:800;
    font-size:12px;
    color:var(--muted);
    text-transform:uppercase;
    letter-spacing:.4px;
  }
  
  .case-item-row .value{
    font-weight:600;
    color:var(--text-dark);
  }
  
  .case-item-notes{
    margin-top:8px;
    padding:12px;
    background:rgba(0,59,115,0.03);
    border-radius:8px;
    font-size:14px;
    line-height:1.6;
    color:var(--blue-2);
  }
  
  .case-item-badges{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:12px;
  }
  
  .case-badge{
    display:inline-block;
    padding:4px 10px;
    border-radius:999px;
    font-size:11px;
    font-weight:800;
    text-transform:uppercase;
    letter-spacing:.5px;
  }
  
  .case-badge.anon{
    background:rgba(217,100,58,0.1);
    color:#9a3d23;
    border:1px solid #f1b39e;
  }
  
  .case-badge.federated{
    background:rgba(14,173,105,0.1);
    color:var(--green);
    border:1px solid var(--green);
  }

  @media (max-width: 600px){
    .case-item-row{
      grid-template-columns:1fr;
      gap:4px;
    }
  }
</style>
</head>
<body>

<header class="eban-header">
  <div class="header-logo">
    <img src="eban-logo.png" alt="√âBAN Logo" style="height:40px; width:auto; filter:brightness(0) invert(1);">
    <div>
      <h1>√âBAN Blueprint</h1>
      <p>Making care visible through ethical data</p>
    </div>
  </div>
</header>

<main>
  <!-- Dashboard -->
  <section id="dashboard">
    <div class="section-header">
      <div class="title">
        üìä Community Care Records
      </div>
      <div class="subtitle">Supporting our community with dignity</div>
    </div>

    <div class="kpi-grid">
      <div class="card">
        <div class="kpi badge" data-badge="GOAL">
          <div class="label">People Supported</div>
          <div class="value" id="valLocalCases">48</div>
          <div class="sub">Individuals welcomed and assisted</div>
        </div>
      </div>

      <div class="card">
        <div class="kpi">
          <div class="label">Informed Consent</div>
          <div class="value" id="valLocalConsent">96%</div>
          <div class="sub">Transparency & trust maintained</div>
        </div>
      </div>

      <div class="card">
        <div class="kpi">
          <div class="label">Privacy Protected</div>
          <div class="value" id="valLocalAnon">12</div>
          <div class="sub">Maximum privacy protection</div>
        </div>
      </div>

      <div class="card">
        <div class="kpi">
          <div class="label">Collective Impact</div>
          <div class="value" id="valNetContrib">19</div>
          <div class="sub">Shared insights for learning</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Welcome -->
  <section id="newCase" class="hidden">
    <div class="section-header">
      <div class="title">
        ü´±üèΩ‚Äçü´≤üèæ Welcome a New Person
      </div>
      <div class="subtitle">Document care with dignity and consent</div>
    </div>

    <form class="form card" id="caseForm" onsubmit="saveCase(event)">
      <div class="row">
        <label for="techName">Your Name (Care Provider) *</label>
        <input 
          type="text" 
          id="techName" 
          placeholder="e.g., Maria Silva" 
          oninput="validateForm()"
          required
        />
        <div class="field-feedback hidden" id="techName-feedback"></div>
      </div>

      <div class="row">
        <label for="personName">Person's Name (Optional)</label>
        <input 
          type="text" 
          id="personName" 
          placeholder="e.g., Jo√£o Santos" 
          oninput="validateForm()"
        />
        <div class="hint">
          üí° If provided, a unique identity code will be generated automatically to protect their privacy
        </div>
      </div>

      <div class="row">
        <label for="pseudonym">Protected Identity Code</label>
        <input 
          type="text" 
          id="pseudonym" 
          placeholder="Will be auto-generated..." 
          readonly
        />
        <div class="hint">
          üîê This code protects identity while maintaining record integrity
        </div>
      </div>

      <div class="row">
        <label for="supportType">Choose the Support Offered *</label>
        <select id="supportType" oninput="validateForm()" required>
          <option value="">‚Äî Select type of care ‚Äî</option>
          <option value="psychological">Emotional & Psychological Care</option>
          <option value="legal">Legal Support & Advocacy</option>
          <option value="medical">Health & Medical Care</option>
          <option value="social">Social Services & Resources</option>
          <option value="other">Other Forms of Support</option>
        </select>
        <div class="field-feedback hidden" id="supportType-feedback"></div>
      </div>

      <div class="row">
        <label for="caseNotes">Session Notes & Reflections üí≠ (Optional)</label>
        <textarea 
          id="caseNotes" 
          placeholder="Brief notes about the support provided, observations, or reflections..."
        ></textarea>
        <div class="hint">
          üí≠ These notes stay private and help document the care journey
        </div>
      </div>

      <div class="checks">
        <label>
          <input type="checkbox" id="consentLocal" onchange="validateForm()" />
          <span><strong>ü´±üèΩ‚Äçü´≤üèæ Informed Consent Obtained *</strong> ‚Äî Person has given informed consent for this local record</span>
        </label>

        <label>
          <input type="checkbox" id="consentFederated" />
          <span><strong>üåç Permission to Share Anonymously</strong> ‚Äî Person consents to anonymized data sharing for collective learning</span>
        </label>

        <label>
          <input type="checkbox" id="anon" />
          <span><strong>üïäÔ∏è Maximum Privacy Protection</strong> ‚Äî Apply additional anonymization protections</span>
        </label>
      </div>

      <button 
        type="submit" 
        class="save" 
        id="btnSave"
        disabled
      >
        üíô Honor Their Story
      </button>
    </form>

    <div class="msg-ok hidden" id="msgOK">
      ‚úì Person's journey documented with care! üíô
    </div>
  </section>

  <!-- Stories -->
  <section id="caseHistory" class="hidden">
    <div class="section-header">
      <div class="title">
        üìñ Stories of Care & Support
      </div>
      <div class="subtitle">Journey Together üí´</div>
    </div>

    <div id="casesList"></div>
  </section>

  <!-- Trust & Consent -->
  <section id="consent" class="hidden">
    <div class="section-header">
      <div class="title">
        ü´±üèΩ‚Äçü´≤üèæ Consent & Trust
      </div>
      <div class="subtitle">Transparency and trust in every interaction</div>
    </div>

    <div class="card">
      <h2 style="margin-top:0">üíô Supporting You Locally</h2>
      
      <p style="line-height:1.7; color:var(--blue-2)">
        <strong>√âBAN</strong> operates on principles of radical transparency and informed consent. 
        <strong>Your autonomy matters.</strong> Every person we serve understands:
      </p>

      <ul style="line-height:1.8; color:var(--text-dark)">
        <li><strong>What data is collected</strong> ‚Äî Only essential information for care coordination</li>
        <li><strong>How it's protected</strong> ‚Äî Pseudonymization, encryption, and access controls</li>
        <li><strong>Who can see it</strong> ‚Äî Only authorized care providers in your network</li>
        <li><strong>Network sharing</strong> ‚Äî Optional, anonymized, and always voluntary</li>
        <li><strong>Your rights</strong> ‚Äî Access, correction, and deletion at any time</li>
      </ul>

      <div style="margin:20px 0; padding:16px; background:rgba(0,59,115,0.04); border-radius:10px">
        <strong style="color:var(--blue)">Core Principle:</strong>
        <p style="margin:8px 0 0; color:var(--text-dark)">
          People aren't "data subjects" ‚Äî they're human beings deserving dignity, respect, and full agency 
          over their information.
        </p>
      </div>

      <button class="save btn-sec" onclick="signConsent(event)">
        ‚úçüèæ Sign with Understanding
      </button>
    </div>

    <div class="card" style="margin-top:16px">
      <h2 style="margin-top:0">üåç Growing Together, Globally</h2>
      
      <p style="line-height:1.7; color:var(--blue-2)">
        <strong>Building collective wisdom</strong> ‚Äî When people consent to network sharing, their anonymized data contributes to collective learning while keeping every individual's identity completely protected and sacred. üíô
      </p>

      <button class="save btn-sec" onclick="signConsent(event)">
        ‚úçüèæ Join Our Collective Learning
      </button>
    </div>
  </section>

  <!-- Impact -->
  <section id="network" class="hidden">
    <div class="section-header network">
      <div class="title">
        üåç Our Collective Impact
      </div>
      <div class="subtitle">Together, we're building a more caring world</div>
    </div>

    <div class="card">
      <h2 style="margin-top:0">üå± How We Learn Together</h2>
      
      <p style="line-height:1.7; color:var(--blue-2)">
        When people consent to network sharing, their anonymized data contributes to:
      </p>

      <ul style="line-height:1.8; color:var(--text-dark)">
        <li><strong>Pattern recognition</strong> ‚Äî Identifying systemic issues requiring policy intervention</li>
        <li><strong>Resource allocation</strong> ‚Äî Understanding where support is most needed</li>
        <li><strong>Quality improvement</strong> ‚Äî Learning what approaches work best</li>
        <li><strong>Advocacy</strong> ‚Äî Evidence-based arguments for social change</li>
      </ul>

      <div style="margin:20px 0; padding:16px; background:rgba(14,173,105,0.06); border-radius:10px; border-left:4px solid var(--green)">
        <strong style="color:var(--green)">üå± Important:</strong>
        <p style="margin:8px 0 0; color:var(--text-dark); font-size:14px">
          Only the lessons learned (never the raw data) are shared... keeping every individual's identity completely protected and sacred. üíô
        </p>
      </div>

      <div class="kpi-grid" style="margin-top:24px">
        <div class="card">
          <div class="kpi">
            <div class="label">Stories Shared Anonymously</div>
            <div class="value" id="netThisOrg">19</div>
            <div class="sub">Your contributions</div>
          </div>
        </div>

        <div class="card">
          <div class="kpi">
            <div class="label">Communities Connected</div>
            <div class="value">42</div>
            <div class="sub">Network nodes</div>
          </div>
        </div>

        <div class="card">
          <div class="kpi">
            <div class="label">Collective Insights</div>
            <div class="value">2,847</div>
            <div class="sub">Global learning pool</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Privacy Shield -->
  <section id="privacy" class="hidden">
    <div class="section-header">
      <div class="title">
        üõ°Ô∏è Privacy Shield
      </div>
      <div class="subtitle">üí´ Protective Display Mode</div>
    </div>

    <div class="card">
      <h2 style="margin-top:0">Privacy Shield</h2>
      
      <p style="line-height:1.7; color:var(--blue-2)">
        When working in public or shared spaces, enable Privacy Shield to mask sensitive information 
        from view while maintaining full functionality.
      </p>

      <div class="privacy-toggle">
        <input 
          type="checkbox" 
          id="privacyToggle" 
          onchange="togglePrivacy(this)"
          role="switch"
          aria-checked="false"
        />
        <div id="privacyText" style="flex:1; font-weight:600; color:var(--blue-2)">
          Full transparency for you.
        </div>
      </div>

      <div style="margin-top:20px; padding:14px; background:rgba(14,173,105,0.06); border-radius:10px; border-left:4px solid var(--green)">
        <strong style="color:var(--green)">‚úì Privacy Protected:</strong>
        <p style="margin:8px 0 0; color:var(--text-dark); font-size:14px">
          When enabled, names and metrics are partially masked from display. 
          All data remains secure and accessible ‚Äî this only affects what's visible on screen.
        </p>
      </div>
    </div>
  </section>

  <!-- Your Journey -->
  <section id="profile" class="hidden">
    <div class="section-header">
      <div class="title">
        üí´ Your Care Journey
      </div>
      <div class="subtitle">Your contribution to ethical care</div>
    </div>

    <div class="card">
      <h2 style="margin-top:0">Your Identity in the System</h2>
      
      <div style="display:grid; gap:16px; margin:20px 0">
        <div>
          <div style="font-weight:800; font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.4px; margin-bottom:6px">
            Care Provider
          </div>
          <div style="font-size:18px; font-weight:900; color:var(--blue)" id="profName">‚Äî</div>
        </div>

        <div>
          <div style="font-weight:800; font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.4px; margin-bottom:6px">
            Your Code
          </div>
          <div style="font-size:16px; font-weight:700; color:var(--text-dark); font-family:monospace" id="profCode">‚Äî</div>
        </div>

        <div>
          <div style="font-weight:800; font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.4px; margin-bottom:6px">
            People Supported
          </div>
          <div style="font-size:18px; font-weight:900; color:var(--green)" id="profNet">0</div>
        </div>

        <div>
          <div style="font-weight:800; font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.4px; margin-bottom:6px">
            Privacy-Protected Stories
          </div>
          <div style="font-size:18px; font-weight:900; color:var(--terra)" id="profAnon">0</div>
        </div>
      </div>

      <button class="save btn-sec" onclick="resetDemo()">
        üîÑ Reset Demo Data
      </button>
    </div>
  </section>
</main>

<button 
  class="fab" 
  onclick="showScreen('newCase')" 
  aria-label="Welcome a new person"
  title="Welcome a New Person"
>
  ü´±üèΩ‚Äçü´≤üèæ
</button>

<nav class="nav" role="navigation" aria-label="Main navigation">
  <a href="#" aria-label="Overview" onclick="showScreen('dashboard');event.preventDefault()">
    üìä
    <span>Overview</span>
  </a>
  <a href="#" aria-label="Welcome" onclick="showScreen('newCase');event.preventDefault()">
    ü´±üèΩ‚Äçü´≤üèæ
    <span>Welcome</span>
  </a>
  <a href="#" aria-label="Stories" onclick="showScreen('caseHistory');event.preventDefault()">
    üìñ
    <span>Stories</span>
  </a>
  <a href="#" aria-label="Impact" onclick="showScreen('network');event.preventDefault()">
    üåç
    <span>Impact</span>
  </a>
  <a href="#" aria-label="More options" onclick="toggleMoreMenu();event.preventDefault()" id="moreBtn">
    ‚ãÆ
    <span>More</span>
  </a>
</nav>

<div class="more-menu" id="moreMenu">
  <a href="#" onclick="showScreen('consent');toggleMoreMenu();event.preventDefault()">
    <span role="img" aria-label="Trust">ü´±üèΩ‚Äçü´≤üèæ</span>
    Trust & Consent
  </a>
  <a href="#" onclick="showScreen('privacy');toggleMoreMenu();event.preventDefault()">
    <span role="img" aria-label="Privacy">üõ°Ô∏è</span>
    Privacy Shield
  </a>
  <a href="#" onclick="showScreen('profile');toggleMoreMenu();event.preventDefault()">
    <span role="img" aria-label="Journey">üí´</span>
    Your Journey
  </a>
</div>

<script>
  // STORAGE EM MEM√ìRIA (funciona em artifacts)
  let appState = {
    local: { cases: 48, consent: 46, anon: 12 },
    net: { contrib: 19 },
    people: [],
    cases: [],
    techName: '',
    techCode: ''
  };

  // GERA√á√ÉO DE C√ìDIGOS
  function randUUID(){
    return (Math.random().toString(16).slice(2) + Date.now().toString(16)).toUpperCase();
  }
  
  function genTechCode(){ 
    return 'EB-' + randUUID().slice(0,8); 
  }
  
  function genPseudonym(name){
    var base = (name || 'AN').trim().toUpperCase().slice(0,2);
    var salt = Math.floor(Math.random() * 255).toString(16);
    return 'BEN-' + base + '-' + (Date.now() % 10000).toString(16) + '-' + salt.toUpperCase();
  }

  // NAVEGA√á√ÉO
  function showScreen(id){
    document.querySelectorAll('main > section').forEach(function(s){ s.classList.add('hidden'); });
    var screen = document.getElementById(id);
    if (screen) screen.classList.remove('hidden');
    updateNav(id);
    window.scrollTo({ top: 0, behavior: 'smooth' });
    
    // Fecha more menu se aberto
    var moreMenu = document.getElementById('moreMenu');
    if (moreMenu) moreMenu.classList.remove('show');
  }

  function updateNav(id){
    var links = document.querySelectorAll('.nav a');
    links.forEach(function(l){ l.removeAttribute('aria-current'); });
    var map = {dashboard:0, newCase:1, caseHistory:2, network:3};
    if (map[id] != null && links[map[id]]) {
      links[map[id]].setAttribute('aria-current', 'page');
    }
  }

  function toggleMoreMenu(){
    var menu = document.getElementById('moreMenu');
    if (menu) menu.classList.toggle('show');
  }

  // Fecha more menu ao clicar fora
  document.addEventListener('click', function(e){
    var menu = document.getElementById('moreMenu');
    var btn = document.getElementById('moreBtn');
    if (menu && btn && !menu.contains(e.target) && !btn.contains(e.target)){
      menu.classList.remove('show');
    }
  });

  // RENDER KPIs
  function render(mask){
    mask = mask || false;
    var L = appState.local;
    var N = appState.net;
    var consentPct = L.cases ? Math.round((L.consent / L.cases) * 100) : 0;

    var vCases = mask ? '‚Ä¢‚Ä¢' : String(L.cases);
    var vConsent = mask ? '‚Ä¢‚Ä¢%' : consentPct + '%';
    var vAnon = mask ? '‚Ä¢‚Ä¢' : String(L.anon);
    var vNet = mask ? '‚Ä¢‚Ä¢' : String(N.contrib);

    var elCases = document.getElementById('valLocalCases');
    var elConsent = document.getElementById('valLocalConsent');
    var elAnon = document.getElementById('valLocalAnon');
    var elNet = document.getElementById('valNetContrib');
    var elNetOrg = document.getElementById('netThisOrg');
    var elProfNet = document.getElementById('profNet');
    var elProfAnon = document.getElementById('profAnon');

    if (elCases) elCases.textContent = vCases;
    if (elConsent) elConsent.textContent = vConsent;
    if (elAnon) elAnon.textContent = vAnon;
    if (elNet) elNet.textContent = vNet;
    if (elNetOrg) elNetOrg.textContent = vNet;
    if (elProfNet) elProfNet.textContent = mask ? '‚Ä¢‚Ä¢' : (N.contrib || 0);
    if (elProfAnon) elProfAnon.textContent = mask ? '‚Ä¢‚Ä¢' : (L.anon || 0);
  }

  // VALIDA√á√ÉO DE FORM
  function validateForm(){
    var tech = document.getElementById('techName').value.trim();
    var person = document.getElementById('personName').value.trim();
    var type = document.getElementById('supportType').value;
    var cLocal = document.getElementById('consentLocal').checked;

    // Feedback inline para t√©cnico
    var techFeedback = document.getElementById('techName-feedback');
    var techInput = document.getElementById('techName');
    if (techFeedback && techInput) {
      if (tech){
        techFeedback.textContent = '‚úì Thank you';
        techFeedback.className = 'field-feedback success';
        techInput.classList.add('success');
        techInput.classList.remove('error');
      } else {
        techFeedback.textContent = 'üíô Please share your name so we can honor this person\'s story';
        techFeedback.className = 'field-feedback error';
        techInput.classList.add('error');
        techInput.classList.remove('success');
      }
    }

    // Feedback inline para tipo de suporte
    var typeFeedback = document.getElementById('supportType-feedback');
    var typeInput = document.getElementById('supportType');
    if (typeFeedback && typeInput) {
      if (type){
        typeFeedback.textContent = '‚úì Wonderful';
        typeFeedback.className = 'field-feedback success';
        typeInput.classList.add('success');
        typeInput.classList.remove('error');
      } else {
        typeFeedback.textContent = 'üíô Help us understand what kind of support you\'re offering';
        typeFeedback.className = 'field-feedback error';
        typeInput.classList.add('error');
        typeInput.classList.remove('success');
      }
    }

    // Gera pseud√≥nimo se tiver nome
    var pseudonymInput = document.getElementById('pseudonym');
    if (person && pseudonymInput && !pseudonymInput.value){
      pseudonymInput.value = genPseudonym(person);
    }

    var ok = tech && type && cLocal;
    var btnSave = document.getElementById('btnSave');
    if (btnSave) {
      btnSave.disabled = !ok;
      btnSave.setAttribute('aria-disabled', String(!ok));
    }
  }

  // SALVAR CASO
  function saveCase(event){
    event.preventDefault();
    
    var tech = document.getElementById('techName').value.trim();
    var person = document.getElementById('personName').value.trim();
    var pseudonymInput = document.getElementById('pseudonym');
    var pseud = pseudonymInput ? (pseudonymInput.value.trim() || genPseudonym(person || 'Anonymous')) : genPseudonym(person || 'Anonymous');
    var type = document.getElementById('supportType').value;
    var notesEl = document.getElementById('caseNotes');
    var notes = notesEl ? notesEl.value.trim() : '';
    var cLocal = document.getElementById('consentLocal').checked;
    var cFed = document.getElementById('consentFederated').checked;
    var anon = document.getElementById('anon').checked;

    if (!tech || !type || !cLocal){ 
      alert('üíô Just a gentle reminder: Please complete the required fields so we can honor this person\'s story properly.');
      return;
    }

    var btnSave = document.getElementById('btnSave');
    if (btnSave) {
      btnSave.classList.add('loading');
      btnSave.disabled = true;
    }

    setTimeout(function(){
      // Gera c√≥digo t√©cnico se n√£o existir
      if (!appState.techCode){
        appState.techCode = genTechCode();
      }
      appState.techName = tech;

      // Cria objeto completo do caso
      var caseObj = {
        id: Date.now(),
        pseud: pseud,
        person: person || 'Anonymous',
        type: type,
        notes: notes,
        technician: tech,
        date: new Date().toISOString(),
        anon: anon,
        federated: cFed,
        localConsent: cLocal
      };

      // Atualiza estado
      if (!appState.people.find(function(p){ return p.pseud === pseud; })){
        appState.people.push({pseud: pseud, person: person || 'Anonymous', type: type});
        appState.local.cases += 1;
        appState.local.consent += 1;
        if (anon) appState.local.anon += 1;
        if (cFed) appState.net.contrib += 1;
      }

      // Adiciona ao hist√≥rico completo
      appState.cases.unshift(caseObj); // Adiciona no in√≠cio para mostrar os mais recentes primeiro

      // Atualiza perfil
      var profName = document.getElementById('profName');
      var profCode = document.getElementById('profCode');
      if (profName) profName.textContent = tech;
      if (profCode) profCode.textContent = appState.techCode;

      // Renderiza
      var privacyToggle = document.getElementById('privacyToggle');
      render(privacyToggle ? privacyToggle.checked : false);
      renderCasesList();

      // Remove loading
      if (btnSave) {
        btnSave.classList.remove('loading');
      }
      
      // Mostra sucesso
      var msg = document.getElementById('msgOK');
      if (msg) {
        msg.classList.remove('hidden');
      }

      setTimeout(function(){
        if (msg) {
          msg.classList.add('hidden');
        }
        showScreen('caseHistory'); // Mostra o hist√≥rico ap√≥s salvar
        
        // Reset form
        var form = document.getElementById('caseForm');
        if (form) {
          form.reset();
        }
        document.querySelectorAll('.field-feedback').forEach(function(el){ 
          el.className = 'field-feedback hidden'; 
        });
        document.querySelectorAll('input, select').forEach(function(el){
          el.classList.remove('error', 'success');
        });
        validateForm();
      }, 2500);
    }, 1500);
  }

  // ASSINAR CONSENTIMENTO
  function signConsent(event){
    var btn = event ? event.target : null;
    if (btn) {
      btn.classList.add('loading');
      btn.disabled = true;

      setTimeout(function(){
        btn.classList.remove('loading');
        btn.disabled = false;
        alert('‚úì Thank you for your trust. Consent recorded with care and transparency on ' + new Date().toLocaleString() + '. üíô');
      }, 1200);
    }
  }

  // PRIVACY TOGGLE
  function togglePrivacy(el){
    if (!el) return;
    
    var mask = el.checked;
    var msg = document.getElementById('privacyText');
    var profName = document.getElementById('profName');
    
    if (msg) {
      if (mask){
        msg.textContent = 'üõ°Ô∏è Privacy Shield ON: Information protected from view while you work.';
        msg.style.color = 'var(--green)';
        if (profName) profName.textContent = 'Protected';
      } else {
        msg.textContent = 'Full transparency for you.';
        msg.style.color = 'var(--blue-2)';
        if (profName) profName.textContent = appState.techName || '‚Äî';
      }
    }
    
    render(mask);
    el.setAttribute('aria-checked', String(mask));
  }

  // RENDERIZAR LISTA DE CASOS
  function renderCasesList(){
    var container = document.getElementById('casesList');
    if (!container) return;

    if (appState.cases.length === 0) {
      container.innerHTML = '<div class="card" style="text-align:center; padding:40px; color:var(--muted)"><span style="font-size:48px">üì≠</span><p style="margin:16px 0 0">No stories documented yet.</p><p style="font-size:13px">Begin by welcoming someone üå±</p></div>';
      return;
    }

    var html = '';
    appState.cases.forEach(function(c){
      var date = new Date(c.date);
      var dateStr = date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });

      var typeLabels = {
        psychological: 'Emotional & Psychological Care',
        legal: 'Legal Support & Advocacy',
        medical: 'Health & Medical Care',
        social: 'Social Services & Resources',
        other: 'Other Forms of Support'
      };

      html += '<div class="case-item">';
      html += '<div class="case-item-header">';
      html += '<div class="pseudonym">' + c.pseud + '</div>';
      html += '<div class="date">' + dateStr + '</div>';
      html += '</div>';
      html += '<div class="case-item-body">';
      html += '<div class="case-item-row">';
      html += '<span class="label">Care Provided:</span>';
      html += '<span class="value">' + (typeLabels[c.type] || c.type) + '</span>';
      html += '</div>';
      html += '<div class="case-item-row">';
      html += '<span class="label">Supported by:</span>';
      html += '<span class="value">' + c.technician + '</span>';
      html += '</div>';
      if (c.notes) {
        html += '<div class="case-item-notes">';
        html += '<strong>üí≠ Reflections:</strong><br>';
        html += c.notes;
        html += '</div>';
      }
      html += '</div>';
      html += '<div class="case-item-badges">';
      if (c.anon) html += '<span class="case-badge anon">üïäÔ∏è Privacy Protected</span>';
      if (c.federated) html += '<span class="case-badge federated">üåç Shared Anonymously</span>';
      if (c.localConsent) html += '<span class="case-badge" style="background:rgba(14,173,105,0.1); color:var(--green); border:1px solid var(--green)">‚úì Trusted</span>';
      html += '</div>';
      html += '</div>';
    });

    container.innerHTML = html;
  }

  // RESET DEMO
  function resetDemo(){
    if (confirm('Are you sure you want to clear all demonstration data? This will start fresh. üå±')){
      appState = {
        local: { cases: 48, consent: 46, anon: 12 },
        net: { contrib: 19 },
        people: [],
        cases: [],
        techName: '',
        techCode: ''
      };
      var privacyToggle = document.getElementById('privacyToggle');
      render(privacyToggle ? privacyToggle.checked : false);
      renderCasesList();
      
      var profName = document.getElementById('profName');
      var profCode = document.getElementById('profCode');
      if (profName) profName.textContent = '‚Äî';
      if (profCode) profCode.textContent = '‚Äî';
      
      alert('‚ú® Demo data cleared. Ready for a fresh start!');
    }
  }

  // BOOT
  window.addEventListener('load', function(){
    var techNameInput = document.getElementById('techName');
    var profName = document.getElementById('profName');
    var profCode = document.getElementById('profCode');
    
    if (appState.techName && appState.techCode){
      if (techNameInput) techNameInput.value = appState.techName;
      if (profName) profName.textContent = appState.techName;
      if (profCode) profCode.textContent = appState.techCode;
    }
    render(false);
    renderCasesList();
    showScreen('dashboard');
  });
</script>

</body>
</html>
